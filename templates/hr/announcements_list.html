{% extends "base.html" %}
{% block title %}ประกาศบริษัท - AccountWorks{% endblock %}
{% block content %}
<h2 class="mb-3">📣 ประกาศบริษัท</h2>

<form method="get" class="row g-2 mb-3">
  <div class="col-md-6">
    <input class="form-control" type="text" name="q" value="{{ q }}" placeholder="ค้นหาหัวข้อหรือเนื้อหา">
  </div>
  <div class="col-md-2">
    <button class="btn btn-primary w-100">ค้นหา</button>
  </div>
  {% if is_manager_or_admin %}
    <div class="col-md-4 text-md-end">
      <a class="btn btn-success" href="{% url 'hr:announcement_add' %}">+ สร้างประกาศ</a>
    </div>
  {% endif %}
</form>

<div class="list-group">
  {% for a in items %}
    <a href="{% url 'hr:announcement_detail' a.pk %}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-start">
      <div class="me-3">
        <div class="fw-semibold">
          {% if a.is_pinned %}📌{% endif %} {{ a.title }}
          {% if not a.is_active %}<span class="badge bg-secondary ms-1">ปิดแสดง</span>{% endif %}
        </div>
        <div class="small text-muted">{{ a.published_at|date:"Y-m-d H:i" }}</div>
      </div>
      <div class="text-muted small">{{ a.created_by|default:"-" }}</div>
    </a>
  {% empty %}
    <div class="alert alert-light border">ยังไม่มีประกาศ</div>
  {% endfor %}
</div>

{% if items.paginator.num_pages > 1 %}
<nav class="mt-3">
  <ul class="pagination">
    {% if items.has_previous %}
      <li class="page-item"><a class="page-link" href="?q={{ q }}&page={{ items.previous_page_number }}">«</a></li>
    {% else %}<li class="page-item disabled"><span class="page-link">«</span></li>{% endif %}
    <li class="page-item disabled"><span class="page-link">หน้า {{ items.number }} / {{ items.paginator.num_pages }}</span></li>
    {% if items.has_next %}
      <li class="page-item"><a class="page-link" href="?q={{ q }}&page={{ items.next_page_number }}">»</a></li>
    {% else %}<li class="page-item disabled"><span class="page-link">»</span></li>{% endif %}
  </ul>
</nav>
{% endif %}
{% endblock %}
