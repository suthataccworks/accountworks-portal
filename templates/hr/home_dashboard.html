{% extends "base.html" %}
{% block title %}Home - AccountWorks{% endblock %}
{% block content %}
<style>
  .aw-section-title{font-weight:700;}
  .aw-card{border:0;border-radius:18px;box-shadow:0 8px 24px rgba(0,0,0,.08);}
  .subtle{color:#6c757d}
  .tile{
    position:relative;
    display:flex;gap:14px;align-items:center;padding:16px;border-radius:16px;text-decoration:none;
    background:linear-gradient(135deg,#f7f9ff,#ffffff);border:1px solid #eef2f6;transition:.15s ease;
  }
  .tile:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(13,110,253,.12);}
  .tile .icon{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;background:rgba(13,110,253,.1);color:#0d6efd;}
  .btn-soft{border-radius:12px;font-weight:600;box-shadow:0 6px 16px rgba(13,110,253,.12);}
  .badge.bg-primary-subtle{background:rgba(13,110,253,.12)!important;color:#0d6efd;}
  /* ‚úÖ ‡∏õ‡πâ‡∏≤‡∏¢‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏° */
  .badge-noti{
    position:absolute; top:-6px; right:-6px;
    min-width:22px; height:22px; padding:0 6px;
    border-radius:999px; display:flex; align-items:center; justify-content:center;
    background:#dc3545; color:#fff; font-weight:700; font-size:.78rem;
    box-shadow:0 4px 10px rgba(220,53,69,.35);
  }
</style>

<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h2 class="aw-section-title mb-1">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö, {{ request.user.first_name|default:request.user.username }}</h2>
    <div class="subtle">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</div>
  </div>
  <div class="d-none d-md-block">
    <a href="{% url 'leave_request' %}" class="btn btn-primary btn-soft">+ ‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤</a>
  </div>
</div>

<div class="row g-4">
  <div class="col-12 col-lg-8">
    <!-- ‡∏Å‡∏≤‡∏£‡πå‡∏î ‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å -->
    <div class="card aw-card">
      <div class="card-body p-4">
        <h5 class="mb-3">‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å</h5>
        <div class="row g-3">
          <div class="col-12 col-md-6">
            <a class="tile" href="{% url 'leave_dashboard' %}">
              <div class="icon">üóìÔ∏è</div>
              <div><div class="fw-semibold">‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏≤‡∏á‡∏≤‡∏ô</div><div class="subtle small">‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ & ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏≤</div></div>
            </a>
          </div>
          <div class="col-12 col-md-6">
            <a class="tile" href="{% url 'leave_request' %}">
              <div class="icon" style="background:rgba(25,135,84,.12);color:#198754;">‚ûï</div>
              <div><div class="fw-semibold">‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤</div><div class="subtle small">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÉ‡∏´‡∏°‡πà</div></div>
            </a>
          </div>
          <div class="col-12 col-md-6">
            <a class="tile" href="{% url 'menu_holidays' %}">
              <div class="icon" style="background:rgba(255,193,7,.15);color:#b78103;">üìå</div>
              <div><div class="fw-semibold">‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</div><div class="subtle small">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î</div></div>
            </a>
          </div>
          <div class="col-12 col-md-6">
            <a class="tile" href="{% url 'menu_courier' %}">
              <div class="icon" style="background:rgba(13,110,253,.12);color:#0d6efd;">üì¶</div>
              <div><div class="fw-semibold">‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß‡πÅ‡∏°‡∏™‡πÄ‡∏ã‡πá‡∏ô‡πÄ‡∏à‡∏≠‡∏£‡πå</div><div class="subtle small">‡∏£‡∏±‡∏ö-‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</div></div>
            </a>
          </div>
          <div class="col-12 col-md-6">
            <a class="tile" href="{% url 'menu_announcements' %}">
              <div class="icon" style="background:rgba(214,51,132,.12);color:#d63384;">üì£</div>
              <div><div class="fw-semibold">‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</div><div class="subtle small">‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div></div>
            </a>
          </div>
          <div class="col-12 col-md-6">
            <a class="tile" href="{% url 'menu_myteam' %}">
              <div class="icon" style="background:rgba(32,201,151,.12);color:#20c997;">üë•</div>
              <div><div class="fw-semibold">‡∏ó‡∏µ‡∏°‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</div><div class="subtle small">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏ó‡∏µ‡∏°</div></div>
            </a>
          </div>

          {% if is_manager_or_admin %}
          <div class="col-12 col-md-6">
            <a class="tile" href="{% url 'manage_requests' %}">
              <div class="icon" style="background:rgba(220,53,69,.12);color:#dc3545;">‚úÖ</div>
              <div><div class="fw-semibold">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤</div><div class="subtle small">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠</div></div>

              {# ‚úÖ ‡∏õ‡πâ‡∏≤‡∏¢‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ pending #}
              {% if pending_count and pending_count|add:0 > 0 %}
                <span class="badge-noti">{{ pending_count }}</span>
              {% endif %}
            </a>
          </div>

          <div class="col-12 col-md-6">
            <a class="tile" href="{% url 'menu_overview' %}">
              <div class="icon" style="background:rgba(13,110,253,.12);color:#0d6efd;">üìä</div>
              <div><div class="fw-semibold">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</div><div class="subtle small">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£</div></div>
            </a>
          </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- ‡∏Å‡∏≤‡∏£‡πå‡∏î ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó (3 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î) -->
    <div class="card aw-card mt-4">
      <div class="card-body p-4">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <h5 class="mb-0">üì£ ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</h5>
          <a class="btn btn-sm btn-outline-secondary" href="{% url 'menu_announcements' %}">‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</a>
        </div>

        {% if latest_announcements %}
          <div class="list-group list-group-flush">
            {% for a in latest_announcements %}
              <a href="{% url 'announcement_detail' a.pk %}" class="list-group-item list-group-item-action px-0 d-flex gap-3">
                <div class="flex-grow-1">
                  <div class="fw-semibold">{% if a.is_pinned %}üìå{% endif %} {{ a.title }}</div>
                  <div class="small subtle">{{ a.published_at|date:"d M Y H:i" }}</div>
                  <div class="small mt-1 text-muted" style="white-space:pre-wrap;">
                    {{ a.content|striptags|truncatechars:120 }}
                  </div>
                </div>
              </a>
            {% endfor %}
          </div>
        {% else %}
          <div class="subtle">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®</div>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="col-12 col-lg-4">
    <div class="card aw-card mb-4">
      <div class="card-body p-4">
        <h5 class="mb-3">‡∏ó‡∏≤‡∏á‡∏•‡∏±‡∏î</h5>
        <div class="d-grid gap-2">
          <a class="btn btn-primary btn-soft" href="{% url 'leave_request' %}">+ ‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤</a>
          <a class="btn btn-outline-secondary btn-soft" href="{% url 'leave_dashboard' %}">‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏≤</a>
          <a class="btn btn-outline-secondary btn-soft" href="{% url 'menu_holidays' %}">‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</a>
        </div>
      </div>
    </div>

    <div class="card aw-card">
      <div class="card-body p-4">
        <h6 class="mb-2">‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö</h6>
        <div class="subtle">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏≤‡∏á‡∏≤‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ó‡∏µ‡∏°‡πÅ‡∏•‡∏∞‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</div>
      </div>
    </div>

    <!-- ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏°‡∏≤‡∏ñ‡∏∂‡∏á -->
    <div class="card aw-card mt-4">
      <div class="card-body p-4">
        <h6 class="mb-3">üìÖ ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏°‡∏≤‡∏ñ‡∏∂‡∏á</h6>
        {% if upcoming_holidays %}
          <ul class="list-group list-group-flush">
            {% for h in upcoming_holidays %}
              <li class="list-group-item px-0 d-flex align-items-center justify-content-between">
                <div>
                  <div class="fw-semibold">{{ h.name }}</div>
                  <div class="subtle small">{{ h.date }}</div>
                </div>
                <span class="badge bg-primary-subtle">‡∏≠‡∏µ‡∏Å {{ h.days_left }} ‡∏ß‡∏±‡∏ô</span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="subtle">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏£‡πá‡∏ß ‡πÜ ‡∏ô‡∏µ‡πâ</div>
        {% endif %}
        <div class="mt-3">
          <a class="btn btn-outline-secondary btn-soft w-100" href="{% url 'menu_holidays' %}">‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
